{% load static %}

<!doctype html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>DataLabz - Login</title>
    <meta content=" sharpdata login page" name="description">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <link href="https://i.imgur.com/QRAUqs9.png" rel="apple-touch-icon">
    <link href="https://i.imgur.com/QRAUqs9.png" rel="shortcut icon">

    <link href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/pixeden-stroke-7-icon@1.2.3/pe-icon-7-stroke/dist/pe-icon-7-stroke.min.css"
          rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.0/css/flag-icon.min.css" rel="stylesheet">
    <link href="{%static 'assets/css/cs-skin-elastic.css'%}" rel="stylesheet">
    <link href="{% static 'assets/css/style.css'%}" rel="stylesheet">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Quantico' rel='stylesheet'>
    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->
    <script async defer src="https://apis.google.com/js/platform.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-78898293-3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-78898293-3');
    </script>
    <style>
        .login-form .btn {
            width: auto !important;
            text-transform: uppercase;
            font-size: 14px;
            padding: 8px 25px;
            border: 1px solid #007bff !important;
        }

        .line {
            display: flex;
            width: 100%;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .line:before,
        .line:after {
            content: '';
            border-top: 2px solid #e2e2e2;
            margin: 0 20px 0 0;
            flex: 1 0 20px;
        }

        .line:after {
            margin: 0 0 0 20px;
        }

        label {
            color: #4c4c4c !important;
            text-transform: capitalize !important;
            font-size: 15px !important;
            background: #ffffff;
            /* transform: translate(15px,7px); */
            margin: 0px;
            transform: translate(15px, 10px);
            padding: 1px 3px;
        }
    </style>
    <script>
        var linkedinLink = "https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=813nyuszjrr3o8&redirect_uri=http://localhost:8080/secure/verify_linkedin&state=fooobar&scope=r_liteprofile%20r_emailaddress%20w_member_social"

    </script>
</head>
<body class="bg-dark">

<div class="sufee-login d-flex align-content-center flex-wrap">
    <div class="container login_container">
        <div class="login-content col-md-6 col-12 m-auto">
            <div class="login-form">
                <div class="login-logo mb-5 mt-2">
                    <a href="/">
<!--                        <h1 style="font-family: 'Quantico'; color:#1d06fb ;font-size: 50px;-->
<!--    font-weight: 600;letter-spacing: 3px;">InterFace</h1>-->
                         <img class="align-content img-fluid" src="{% static 'images/logo.png'%}" alt="">
                    </a>
                </div>
                 {% if not has_code and not is_error %}
                <div><h6>We sent you an email with an OTP code. Please click on that link to reset your password!</h6></div>
                {% elif is_error %}
                <div><h6>Seem like the password you enter is same as old password, Please try to login or retry the password reset!</h6></div>
                {% else %}
                <form action="{% url 'forgot_password' %}" method="POST" id="forgotForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="user_email">Email</label>
                        <input class="form-control" id="user_email" name="user_email" placeholder="" required=""
                               type="text" value="{{email}}"/>
                    </div>
                    <div class="form-group">
                        <label for="user_email">OTP</label>
                        <input class="form-control" id="otp" name="otp" placeholder="" required="" type="text", value="{{otp_code}}"/>
                    </div>
                    <div class="form-group">
                        <label for="new_password">New Password</label>
                        <input class="form-control" id="new_password" name="new_password" placeholder="" required=""
                               type="password"/>
                    </div>
                    <div id="popover-password">
                        <p>Password : <span id="result"> </span></p>
                        <div class="progress">
                            <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="40"
                                 class="progress-bar progress-bar-success" id="password-strength" role="progressbar" style="width:0%">
                            </div>
                        </div>
                        <ul class="list-unstyled">
                            <li class=""><span class="low-upper-case"><i aria-hidden="true"
                                                                         class="fa fa-file-text"></i></span>&nbsp; 1
                                lowercase &amp; 1 uppercase
                            </li>
                            <li class=""><span class="one-number"><i aria-hidden="true"
                                                                     class="fa fa-file-text"></i></span> &nbsp;1
                                number (0-9)
                            </li>
                            <li class=""><span class="one-special-char"><i aria-hidden="true"
                                                                           class="fa fa-file-text"></i></span>
                                &nbsp;1 Special Character (!@#$%^&*).
                            </li>
                            <li class=""><span class="eight-character"><i aria-hidden="true"
                                                                          class="fa fa-file-text"></i></span>&nbsp; Atleast 8
                                Character
                            </li>
                        </ul>
                    </div>
                    <div class="form-group">
                        <label for="user_confirm_password">Confirm Password</label>
                        <span class="hide pull-right block-help" id="popover-cpassword" style="display: none;"><i
                                aria-hidden="true"
                                class="fa fa-info-circle text-danger"></i> Passwords don't match</span>
                        <span class="hide pull-right block-help" id="popover-cpassword-2" style="display: none;"><i
                                aria-hidden="true" class="fa fa-info-circle text-danger"></i> Password is Invalid</span>
                        <input class="form-control" id="user_confirm_password" name="user_confirm_password"
                               required="" onkeypress="validateExuser()" type="password"/>
                    </div>
                    <div class="form-group d-flex justify-content-center mt-4 mb-2">
                        <button class="btn btn-outline-primary submit mx-2" type="submit" id="sign-up" disabled>Confirm</button>
                    </div>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<script crossorigin="anonymous"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-match-height@0.7.2/dist/jquery.matchHeight.min.js"></script>
<script src="{% static 'assets/js/main.js'%}"></script>
<script>
    var linkedinLink = "https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=813nyuszjrr3o8&redirect_uri=http://localhost:8080/secure/verify_linkedin&state=fooobar&scope=r_liteprofile%20r_emailaddress%20w_member_social"


    function onSignIn(googleUser) {
        var id_token = googleUser.getAuthResponse().id_token;
        var profile = googleUser.getBasicProfile();
        console.log("Id token: ", id_token);
        location.replace("/secure/verify_google?idtoken=" + id_token);
        console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
        console.log('Name: ' + profile.getName());
        console.log('Image URL: ' + profile.getImageUrl());
        console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
        // The ID token you need to pass to your backend:
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("ID Token: " + id_token);
    }

    var validPass = false;
    function validateExuser(){
            if(validPass != false){
                $('#sign-up').attr("disabled", false);
            }
            else{
                $('#sign-up').attr("disabled", true);
            }
        }
    $(document).ready(function () {
    $('#new_password').on({input:(function () {
        var password = $('#new_password').val();
        if (checkStrength(password) == false) {
            var a = 1;
        }
    })
    });
        $('#user_confirm_password').on({input:(function () {
            $('#sign-up').attr("disabled", true);
            if ($('#new_password').val() != $('#user_confirm_password').val()) {
                $('#popover-cpassword').css("display", "block");
                validPass = false
            } else {
                validPass = true
                $('#popover-cpassword').css("display", "none");
                if (checkStrength($('#new_password').val()) == false) {
                    $('#popover-cpassword-2').css("display", "block");
                    validPass = false
                } else {
                    validPass = true
                    $('#popover-cpassword-2').css("display", "none");
                    validateExuser()
                }

            }
        })
        });

    function checkStrength(password) {
            var strength = 0;


            //If password contains both lower and uppercase characters, increase strength value.
            if (password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)) {
                strength += 1;
                $('.low-upper-case').addClass('text-success');
                $('.low-upper-case i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');


            } else {
                $('.low-upper-case').removeClass('text-success');
                $('.low-upper-case i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            //If it has numbers and characters, increase strength value.
            if (password.match(/([a-zA-Z])/) && password.match(/([0-9])/)) {
                strength += 1;
                $('.one-number').addClass('text-success');
                $('.one-number i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');

            } else {
                $('.one-number').removeClass('text-success');
                $('.one-number i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            //If it has one special character, increase strength value.
            if (password.match(/([!,%,&,@,#,$,^,*,?,_,~])/)) {
                strength += 1;
                $('.one-special-char').addClass('text-success');
                $('.one-special-char i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');

            } else {
                $('.one-special-char').removeClass('text-success');
                $('.one-special-char i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }

            if (password.length > 7) {
                strength += 1;
                $('.eight-character').addClass('text-success');
                $('.eight-character i').removeClass('fa-file-text').addClass('fa-check');
                $('#popover-password-top').addClass('hide');

            } else {
                $('.eight-character').removeClass('text-success');
                $('.eight-character i').addClass('fa-file-text').removeClass('fa-check');
                $('#popover-password-top').removeClass('hide');
            }


            // If value is less than 2

            if (strength == 0) {
                $('#result').removeClass();
                $('#result').addClass('text-danger').text('Invalid')
                $('#password-strength').css('width', '0%');
                return false;
            } else if (strength == 1) {
                $('#result').removeClass()
                $('#password-strength').addClass('progress-bar-danger');

                $('#result').addClass('text-danger').text('Invalid');
                $('#password-strength').css('width', '25%');
                return false;
            } else if (strength == 2) {
                $('#result').addClass('good');
                $('#password-strength').removeClass('progress-bar-danger');
                $('#password-strength').addClass('progress-bar-warning');
                $('#result').addClass('text-danger').text('Invalid')
                $('#password-strength').css('width', '50%');
                return false;
            } else if (strength == 3) {
                $('#result').removeClass();
                $('#password-strength').removeClass('progress-bar-danger');
                $('#password-strength').addClass('progress-bar-warning');
                $('#result').addClass('text-warning').text('Invalid')
                $('#password-strength').css('width', '75%');
                return false;
            } else if (strength == 4) {
                $('#result').removeClass()
                $('#result').addClass('strong');
                $('#password-strength').removeClass('progress-bar-warning');
                $('#password-strength').addClass('progress-bar-success');
                $('#result').addClass('text-success').text('Valid');
                $('#password-strength').css('width', '100%');

                return true;
            }

        }

        $('#forgotForm').submit(function() {
            var password = $('#new_password').val();
            return checkStrength(password)
        });

    }

    );

    function checkSubmission() {
        alert('checkSubmission');
        var password = document.getElementById("new_password").value;
        var password_verify = document.getElementById("user_confirm_password").value;
        verifyPassword_response = verifyPassword(password, password_verify);
        if (verifyPassword_response == true) {
            return true;
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Oops..!',
                text: 'Some Error!',
                footer: '<a href>Why do I have this issue?</a>'
            })
            return false;
        }
    }

    var password = document.getElementById("new_password")
        , confirm_password = document.getElementById("user_confirm_password");

    function validatePassword() {
        if (password.value != confirm_password.value) {
            confirm_password.setCustomValidity("Passwords Don't Match");
        } else {
            confirm_password.setCustomValidity('');
        }
    }

    password.onchange = validatePassword;
    confirm_password.onchange = validatePassword;

    {% if is_error == '1' %}

    swal({
        title: '{{message_title}}',
        text: '{{message}}',
        icon: 'error',
        confirmButtonText: 'Ok'
    })
    {% endif %}

</script>
</body>
</html>
