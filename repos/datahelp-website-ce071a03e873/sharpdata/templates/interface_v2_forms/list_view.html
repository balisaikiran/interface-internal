<!DOCTYPE html>

{% load static %}

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
  
    <!-- jquery-ui -->
    <link href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet">
    <!-- Fonts CDN -->
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous" />

</head>

<body class="bg-white">
    <style>
        .tag{
            width:25px;
            position: absolute;
            margin-left: -10px;
        }
        * {
            box-sizing: border-radius;
            font-family: "poppins" !important;
        }

        body {
            font-size: 13px;
            font-family: "poppins" !important;
            /*min-height: 400px;
             /* Added as bugfix */
            overflow-x: hidden;
	        overflow-y: visible;
        }

        .add-on:hover {
            transform: scale(1.2);
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: ease-out 0.2s;
        }

        :root {
            --background-color: #eeeef5;
            --primary: #065697;
            --primary-hover: #065697;
        }

        .shadow-add {
            box-shadow: 0px 8px 8px rgba(0, 0, 0, 0.2);
        }

        .hrx {
            opacity: 0.1;
            margin-bottom: 9px;
            margin-top: 9px;
        }

        .card-chip:hover {
            box-shadow: 0 0.3rem 0.5rem rgba(0, 0, 0, .05) !important;
            transition: ease-out 0.1s;
        }

        .card-chip {
            cursor: pointer;
            border-width: 0.3px !important;
            border: 1px #E1DFDF solid !important;
            border-radius: 15px !important;
            /* overflow: hidden; */
            /* margin-left: 1.5rem; */
        }
        .brdf{
            border-radius: 15px 15px 0px 0px;
        }

        .bd {
            border: solid red 1px !important;
        }

        a {
            cursor: pointer;
        }

        a:hover {
            color: inherit;
        }

        .bg-color-1 {
            background: #F5f5f5;
        }

        .pointer {
            cursor: pointer;
        }

        img {
            object-fit: cover;
        }

        .btn-primary {
            background-color: var(--primary);
            font-size: 14px;
            border-color: var(--primary);
            color: #fff;
            outline: none !important;
        }

        .btn-primary:hover,
        .btn-primary:focus,
        .btn-primary:active {
            background-color: transparent;
            border-color: var(--primary-hover);
            color: #065697;
            outline: 0px !important;
        }

        .btn-primary-outline {
            background-color: transparent;
            border-color: var(--primary);
            color: var(--primary);
            outline: 0px !important;
        }

        .btn-primary-outline:hover,
        .btn-primary-outline:focus,
        .btn-primary-outline:active {
            background-color: var(--primary);
            border-color: var(--primary);
            color: #ffffff;
            outline: 0px !important;
        }

        .text-primary {
            color: var(--primary) !important;
        }

        a {
            text-decoration: none;
            color: inherit;
        }
        a:hover {
            text-decoration: none;
            color: inherit;
        }
        a:hover .m-0.fs-6{
          text-decoration: underline;
        }

        .iconify {
            width: 20px;
        }
        select{
            border: 0;
            background-color: #F5f5f5;
        }

        .terminate-button{
            background-color: white; 
            color: red;
            border: none;
            font-size: small;
            float: right;
        }

        canvas {
            display: block;
            /*vertical-align: bottom; */
          }
      
          /* ---- tsparticles container ---- */
        #tsparticles {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
          }

          .confetti-div {
            overflow-y: auto;
            /* min-height: 575px; */
         }

         .terminate-div{
          width: 100%;
         }

         .create-btn a{
          color: white;
         }

         :disabled{
         background: #9EBDD5 !important;
         border: none;
      }
    </style>
    <!-- <div class="confetti-div"> -->

    <div id="loader" style="display: none;">
        {% include "common_form/loader.html" %}    
    </div>
    <section class="container p-0 px-2 pe-3 py-4 bg-white mx-auto my-auto" id="container">
        <div class="w-100" id="workoutListMainDiv">
          {% if chatgpt_integration %}
          <a onclick="showLoaderOnClick('/chat/list_conversations?context={{context_data}}&signature={{signature}}')">
            <div class=" d-flex flex-wrap justify-content-between align-items-center custom-card-borderx bg-color-1 border text-wrap w-100 mb-4 px-3 py-2" style="border-radius:15px;">
              <div class="d-flex align-items-center">
                <img src="https://interface.re/wp-content/uploads/2023/04/gpt.png" width="20">
                <b class="ps-1 fw-bold">Try New ChatGPT</b>
              </div>
              
              <i class="iconify text-muted" data-icon="mdi:info"></i>
            </div>
          </a>
            {% endif %}


            <div class=" mb-4 d-flex justify-content-between align-items-center create-btn">
                <h5 style="font-size:1rem; font-weight: bold;" class="p-0 m-0 fw-bold">Opportunities
                    <b>({{oppurtunity_list|length}})</b></h5>
                <hr class="hr col">
                    <a onclick="showLoaderOnClick('/interface_forms/interface_form?context={{context_data}}&signature={{signature}}')"
                    class="btn btn-lg btn-primary d-flex align-items-center justify-content-center shadow-add p-0 rounded-circle shadow-lg"
                    style="width: 25px !important; height: 25px !important;">
                    <i class="fs-5 iconify" data-icon="mdi:plus"></i>
                  </a>
            </div>

            <div class="d-flex mb-4 flex-column justify-content-center align-items-center">
                {% for op in oppurtunity_list %}
                {% if not op.notshow %}
                <div class="mb-4 card-chip custom-card-borderx
                rounded rounded-3 w-100 bg-white">
                {% if is_tagsSystem and op.is_tagged %}
                     <!-- tag icon iamge -------------- -->
                     <img style="z-index: 1;" src="{% static 'img/tags.png' %}" class="tag"> 
                      <!-- tag icon iamge -------------- -->
                    {% endif %}
                            {% if op.opp_stage == 'Closed' or op.opp_stage == 'Terminated' %}
                            <a class="d-flex flex-column w-100 pb-0 px-03 justify-content-center">{% else %}
                            <a href="#" class="d-flex flex-column w-100 pb-0 justify-content-center update-form-link"
                            onclick="showLoaderOnClick('/interface_forms/update_interface_form?stage={{op.opp_stage}}&opp_key={{op.opp_key}}&context={{context_data}}&signature={{signature}}')">
                            {% endif %}
                                   
                                    <div class="d-flex flex-wrap brdf bg-color-1 text-wrap w-100 px-3 py-3 border-bottom align-items-center justify-content-between">
                                        <b class="fs-6 m-0 fw-bold small">{{op.opp_stage}}</b>
                                        {% if op.opp_forecasted_close_date %}
                                        <p class="d-flex align-items-center m-0 p-0"><i class="iconify me-1"
                                                data-icon="fontisto:date"></i>
                                            {{op.opp_forecasted_close_date}}
                                        </p>
                                        {% endif %}
                                    </div>
                               

                                    <div class="d-flex flex-column pt-3 pb-2 px-3 text-wrap w-100 justify-content-between">
                                        <div class="d-flex mb-3 flex-wrap w-100">
                                            <b class="fw-bold pe-2">{{op.opp_last_name}}{% if op.opp_address %}: </b><span class="">{{op.opp_address}}</span>{% else %}</b>{% endif %}
                                        </div>

                                        <div class="d-flex w-100 flex-wrap text-wrap justify-content-between">
                                            <span class=""> {% if op.opp_stage == 'Appointment Set' or op.opp_stage == 'Pipeline' %}
                                                {% if op.appt_set_lead_type %}
                                                {{op.appt_set_lead_type}}
                                                {% else %}
                                                {{op.opp_type}}
                                                {% endif %}
                                                {% else %}
                                                {{op.opp_type}}
                                                {% endif %}
                                            </span>
                                            <p class="m-0 p-0"><i class="iconify"
                                                    data-icon="material-symbols:real-estate-agent-outline"></i>
                                                <b>ISA:</b> {% if op.opp_isa %} {{op.opp_isa}} {% else %} N/A {% endif %}
                                            </p>
                                        </div>
                                    </div>

                                    <hr class="hrx w-100">

                                    <div class="sub-links d-flex pb-2 w-100 px-3 justify-content-between align-items-center">
                                        <h5 class="fw-bold fs-6 mb-2">{% if op.opp_price %}$ {{op.opp_price}}{% endif %} </h5>
                                        <span class="link-span">
                                            {% if op.otc_property_id and op.opp_stage != 'Terminated' %}
                                            <!-- <a href="https://app.opentoclose.com/#projects/dashboard?type=properties" target="_blank" -->
                                                <img onclick="window.open('https://app.opentoclose.com/#projects/dashboard?type=properties', '_blank')" class="add-on bg-white p-1 mx-2 rounded border mb-2" height="30"
                                                src="https://opentoclose.com/images/logo_purple.png">
                                                <!-- </a> -->
                                                {% endif %}
                                                {% if op.sisu_client_id and op.opp_stage != 'Terminated' %}
                                                <!--a href="https://my.sisu.co/transactions/edit/{{op.sisu_client_id}}" target="_blank"-->
                                                <img onclick="window.open('https://my.sisu.co/transactions/edit/{{op.sisu_client_id}}', '_blank')" class="add-on rounded bg-white border mb-2" height="30"
                                                src="{% static 'img/sisu.png' %}" alt="Sisu Transaction">
                                                <!-- </a> -->
                                                {% endif %}
                                </span>
                                </div>
                                </a>
                </div>
                {% endif %}
                {% empty %}
                <div class="d-flex mb-4 mt-4 flex-column justify-content-center align-items-center">
                    <img
                        src="{% static 'img/empty-state.png' %}">
                    <h5 class="fs-6 my-3 fw-bold">No Opportunities Found</h5>
                    <a onclick="showLoaderOnClick('/interface_forms/interface_form?context={{context_data}}&signature={{signature}}')">
                    <b class="pointer text-decoration-underline text-primary">Add
                            New+</b></a>
                </div>

            </div>
            {% endfor %}

            <hr class="hr col-12">

            <div class="mt-4 mb-4 d-flex flex-column justify-content-center align-items-center">
            <img src="https://datalabz.re/static/images/interface_logo.png" width="180">
            <a href="https://knowledge.interface.re/fub-embedded-app-documentation" target="_blank"
              class="text-decoration-underline text-dark mt-2">Learn more about InterFace</a>
            </div>

    
    </section>
<!-- </div> -->
    <!-- Jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <!-- Iconify icons -->
    <script src="https://code.iconify.design/1/1.0.6/iconify.min.js"></script>
    <!-- Bootstrap JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>
    <!-- follow-up-boss -->
    <script src="https://eia.followupboss.com/embeddedApps-v1.0.0.js" type="text/javascript"></script>

    <script>

        function showLoader() {
            document.getElementById('container').style.display = "none";
            document.getElementById('loader').style.display = "block";

        }

        var timeout;

        function sleep(delay, url) {
            if (timeout) {
                clearTimeout(timeout);
            }
            timeout = setTimeout(function () {
                window.location.href = url;
            }, delay);
        }

        function showLoaderOnClick(url) {
            showLoader();
            console.log("sleep for 0.5 second");
            sleep(500, url);
            console.log(url);

        }
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  
    <script>
        var date = new Date();

        var day = ("0" + date.getDate()).slice(-2);
        var month = ("0" + (date.getMonth() + 1)).slice(-2);

        var today = date.getFullYear() + "-" + (month) + "-" + (day);

        $('.opp_date').val(today);
    </script>

    <script> 
      // to prevent all children from triggering the parent event
      $('.update-form-link > .sub-links > .link-span').click(
      function(e) {
          e.stopPropagation();
        }
      );
    </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</body>